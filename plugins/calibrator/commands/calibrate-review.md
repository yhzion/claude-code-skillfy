---
name: calibrate review
description: ëˆ„ì  íŒ¨í„´ í™•ì¸ ë° Skill ìŠ¹ê²©
---

# /calibrate review

ë°˜ë³µëœ íŒ¨í„´ì„ í™•ì¸í•˜ê³  Skillë¡œ ìŠ¹ê²©í•©ë‹ˆë‹¤.

## i18n ë©”ì‹œì§€ ì°¸ì¡°

ëª¨ë“  ì‚¬ìš©ì ëŒ€ë©´ ë©”ì‹œì§€ëŠ” `plugins/calibrator/i18n/messages.json`ì„ ì°¸ì¡°í•©ë‹ˆë‹¤.
ì‹¤í–‰ ì‹œ `.claude/calibrator/config.json`ì˜ `language` í•„ë“œë¥¼ ì½ì–´ í•´ë‹¹ ì–¸ì–´ ë©”ì‹œì§€ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

```bash
# jq ì‚¬ìš©ìœ¼ë¡œ ì•ˆì •ì ì¸ JSON íŒŒì‹±
LANG=$(jq -r '.language // "en"' .claude/calibrator/config.json 2>/dev/null)
LANG=${LANG:-en}  # ê¸°ë³¸ê°’: ì˜ì–´
```

## ì‹¤í–‰ ì „ í™•ì¸

### Step 0: ì˜ì¡´ì„± ë° DB í™•ì¸
```bash
# í•„ìˆ˜ ì˜ì¡´ì„± ì²´í¬
if ! command -v sqlite3 &> /dev/null; then
  echo "âŒ Error: sqlite3 is required but not installed."
  exit 1
fi

# DB ì¡´ì¬ í™•ì¸
if [ ! -f .claude/calibrator/patterns.db ]; then
  # i18n í‚¤ `calibrate.run_init_first` ì•ˆë‚´
  exit 1
fi
```

## í”Œë¡œìš°

### Step 1: ìŠ¹ê²© ëŒ€ìƒ ì¡°íšŒ (ì—ëŸ¬ í•¸ë“¤ë§ í¬í•¨)
```bash
DB_PATH=".claude/calibrator/patterns.db"

# ì¿¼ë¦¬ ì‹¤í–‰ (ì—ëŸ¬ í•¸ë“¤ë§)
CANDIDATES=$(sqlite3 "$DB_PATH" "SELECT id, situation, instruction, count FROM patterns WHERE count >= 2 AND promoted = FALSE ORDER BY count DESC;" 2>/dev/null)
if [ $? -ne 0 ]; then
  echo "âŒ Error: Failed to query database"
  exit 1
fi
```

### Step 2-A: ëŒ€ìƒ ì—†ìŒ
i18n í‚¤ ì°¸ì¡°:
- `review.no_patterns_title` - íƒ€ì´í‹€
- `review.no_patterns_desc` - ì„¤ëª…

ì˜ì–´ ì˜ˆì‹œ:
```
ğŸ“Š No patterns available for promotion

Patterns need to repeat 2+ times to be promoted to a Skill.
Keep recording with /calibrate.
```

### Step 2-B: ëŒ€ìƒ ìˆìŒ
i18n í‚¤ ì°¸ì¡°:
- `review.promotion_title` - íƒ€ì´í‹€
- `review.promotion_select` - ì„ íƒ í”„ë¡¬í”„íŠ¸

ì˜ì–´ ì˜ˆì‹œ:
```
ğŸ“Š Skill Promotion Candidates (2+ repetitions)

[1] Model creation â†’ include timestamp (3 times)
[2] API endpoint â†’ error handling (2 times)
[3] Component creation â†’ Props type definition (2 times)

Select number(s) to promote (comma-separated for multiple): _
```

### Step 3: Skill ë¯¸ë¦¬ë³´ê¸°
i18n í‚¤ ì°¸ì¡°:
- `review.preview_title` - ë¯¸ë¦¬ë³´ê¸° íƒ€ì´í‹€
- `review.skill_learned_from` - learned_from ë©”íƒ€ë°ì´í„° (placeholders: {count}, {first_seen}, {last_seen})
- `review.skill_section_rules` - ê·œì¹™ ì„¹ì…˜ í—¤ë”
- `review.skill_section_applies` - ì ìš© ìƒí™© ì„¹ì…˜ í—¤ë”
- `review.save` / `review.edit` / `review.skip` - ë²„íŠ¼

ì„ íƒëœ ê° íŒ¨í„´ì— ëŒ€í•´ (ì˜ì–´ ì˜ˆì‹œ):
```
ğŸ“ Skill Preview: {situation}

---
name: {kebab-case situation}
description: {instruction}. Auto-applied in {situation} situations.
learned_from: calibrator ({count} repetitions, {first_seen} ~ {last_seen})
---

## Rules

{instruction}

## Applies to

- {situation}

## Learning History

This Skill was auto-generated by Calibrator.
- First detected: {first_seen}
- Last detected: {last_seen}
- Repetitions: {count}

---

[Save] [Edit] [Skip]
```

### Step 4: Skill ìƒì„±
ì €ì¥ ì„ íƒ ì‹œ:
```bash
# Skill ì´ë¦„ ìƒì„± (kebab-case) - Path Traversal ë°©ì§€
SKILL_NAME=$(printf '%s' "$SITUATION" | tr ' ' '-' | tr '[:upper:]' '[:lower:]' | sed 's/[^a-z0-9ê°€-í£-]//g')
# ê¸¸ì´ ì œí•œ (ìµœëŒ€ 50ì)
SKILL_NAME=$(printf '%s' "$SKILL_NAME" | cut -c1-50)
# ë¹ˆ ì´ë¦„ì¸ ê²½ìš° íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ ì´ë¦„ ìƒì„±
if [ -z "$SKILL_NAME" ] || [ "$SKILL_NAME" = "-" ]; then
  SKILL_NAME="skill-$(date +%Y%m%d-%H%M%S)"
fi

# Skill ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p ".claude/skills/learned/$SKILL_NAME"

# sed ì¹˜í™˜ìš© ë³€ìˆ˜ ì´ìŠ¤ì¼€ì´í•‘ (íŠ¹ìˆ˜ë¬¸ì: &, \, /)
escape_sed() {
  printf '%s' "$1" | sed -e 's/[&/\]/\\&/g'
}
SAFE_SKILL_NAME=$(escape_sed "$SKILL_NAME")
SAFE_INSTRUCTION=$(escape_sed "$INSTRUCTION")
SAFE_SITUATION=$(escape_sed "$SITUATION")

# í…œí”Œë¦¿ íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ Skill ìƒì„±
sed -e "s|{{SKILL_NAME}}|$SAFE_SKILL_NAME|g" \
    -e "s|{{INSTRUCTION}}|$SAFE_INSTRUCTION|g" \
    -e "s|{{SITUATION}}|$SAFE_SITUATION|g" \
    -e "s|{{COUNT}}|$COUNT|g" \
    -e "s|{{FIRST_SEEN}}|$FIRST_SEEN|g" \
    -e "s|{{LAST_SEEN}}|$LAST_SEEN|g" \
    plugins/calibrator/templates/skill-template.md > ".claude/skills/learned/$SKILL_NAME/SKILL.md"

# SQL Injection ë°©ì§€: ì‹±ê¸€ì¿¼íŠ¸ ì´ìŠ¤ì¼€ì´í•‘
SAFE_SKILL_PATH=$(printf '%s' ".claude/skills/learned/$SKILL_NAME" | sed "s/'/''/g")
# patterns í…Œì´ë¸” ì—…ë°ì´íŠ¸
sqlite3 .claude/calibrator/patterns.db "UPDATE patterns SET promoted = TRUE, skill_path = '$SAFE_SKILL_PATH' WHERE id = {id};"
```

### Step 5: ì™„ë£Œ
i18n í‚¤ ì°¸ì¡°:
- `review.complete_title` - ì™„ë£Œ íƒ€ì´í‹€
- `review.complete_desc` - ì™„ë£Œ ì„¤ëª… (placeholder: {situation})

ì˜ì–´ ì˜ˆì‹œ:
```
âœ… Skill created

- .claude/skills/learned/{skill-name}/SKILL.md

Claude will now automatically apply this rule in "{situation}" situations.
```

## ì°¸ê³ : Skill ì´ë¦„ ë³€í™˜ ê·œì¹™

situationì„ kebab-caseë¡œ ë³€í™˜:
- ê³µë°± â†’ í•˜ì´í”ˆ
- ëŒ€ë¬¸ì â†’ ì†Œë¬¸ì
- íŠ¹ìˆ˜ë¬¸ì ì œê±°
- ì˜ˆ: "ëª¨ë¸ ìƒì„±" â†’ "ëª¨ë¸-ìƒì„±"
- ì˜ˆ: "API ì—”ë“œí¬ì¸íŠ¸" â†’ "api-ì—”ë“œí¬ì¸íŠ¸"
